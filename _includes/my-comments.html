<!-- {% assign disqus = site.disqus | default:site.disqus_shortname %} -->

{% if site.valine.enable %}
<div id="disqus_thread"></div>
<script>
  !function(w, d){
    if(d.getElementById("disqus_thread")){
      w.disqus_config = function disqusConfig() {
        this.page.url = w.location.href;
        this.page.title = d.title;
      };
      w.loadJSDeferred(d.getElementById("_hrefav").href + '/static/js/3.0.4/av-min.js');
      w.loadJSDeferred(d.getElementById("_hrefvaline").href + 'valine/dist/Valine.min.js');
    }
  }(window, document);

  var GUEST = ['nick','mail','link'];
  var guest = '{{site.valine.guest_info}}';
  guest = guest.split(',').filter(function(item){
    return GUEST.indexOf(item)>-1;
  })
  new Valine({
    el: '#disqus_thread',
    verify: {{ site.valine.verify }},
    notify: {{ site.valine.notify }},
    appId: '{{ site.valine.appid }}',
    appKey: '{{ site.valine.appkey }}',
    placeholder: '{{site.valine.placeholder}}',
    avatar: '{{site.valine.avatar}}',
    meta: guest,
    pageSize: '{{site.valine.pageSize}}' || 10,
    visitor: {{site.valine.visitor}}
  });
</script>
{% endif %}
